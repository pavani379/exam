 manual code tested in testing branch

